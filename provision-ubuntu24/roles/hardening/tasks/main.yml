- name: Load container detection
  include_vars: ../vars/is_container.yml

- name: Include auditd controls
  include_tasks: auditd.yml
  when:
    - "'auditd' in stig_enabled_tags"
    - not system_is_container | default(false)

- name: Include SSH controls
  include_tasks: ssh.yml
  when:
    - "'ssh' in stig_enabled_tags"
    - not system_is_container | default(false)

- name: Include cron controls
  include_tasks: cron.yml
  when:
    - "'cron' in stig_enabled_tags"
    - not system_is_container | default(false)

- name: Include disruption controls
  include_tasks: disruption.yml
  when:
    - ubuntu24stig_disruption_high | bool
