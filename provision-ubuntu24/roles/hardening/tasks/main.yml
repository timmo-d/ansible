- name: Ensure auditd is installed
  apt:
    name: auditd
    state: present
  tags: [stig, rule_id: "SV-230346r627751_rule"]

- name: Disable core dumps
  sysctl:
    name: fs.suid_dumpable
    value: 0
    state: present
    sysctl_set: yes
  tags: [stig, rule_id: "SV-230345r627750_rule"]

- name: Restrict use of cron
  file:
    path: /etc/cron.allow
    state: touch
    mode: '0600'
  tags: [stig, rule_id: "SV-230347r627752_rule"]

- name: Disable IPv6 if not required
  sysctl:
    name: net.ipv6.conf.all.disable_ipv6
    value: 1
    state: present
    sysctl_set: yes
  tags: [stig, rule_id: "SV-230348r627753_rule"]

- name: Ensure permissions on /etc/passwd
  file:
    path: /etc/passwd
    owner: root
    group: root
    mode: '0644'
  tags: [stig, rule_id: "SV-230349r627754_rule"]
