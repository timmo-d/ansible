# ======================= Kibana Configuration =========================

# Server configuration
server.host: "0.0.0.0"
server.port: 5601
server.name: "kibana-siem"

# Elasticsearch connection
elasticsearch.hosts: ["http://localhost:9200"]
elasticsearch.username: "wazuh_indexer_username"
elasticsearch.password: "wazuh_indexer_password"

# SSL (Wazuh Indexer uses HTTPS by default)
elasticsearch.ssl.verificationMode: none

# Wazuh plugin
wazuh.enable: true
wazuh.url: "https://localhost:55000"


# Enable SSL if required
# server.ssl.enabled: true
# server.ssl.certificate: "/path/to/cert.pem"
# server.ssl.key: "/path/to/key.pem"

# Logging configuration
logging.root.level: "info"
logging.appenders:
  file:
    type: file
    fileName: "/var/log/kibana/kibana.log"
    layout:
      type: json
logging.loggers:
  - name: "plugins"
    level: "warn"
  - name: "elasticsearch"
    level: "error"

# Security settings
xpack.security.enabled: true
#xpack.security.session.idleTimeout: "30m"
#xpack.security.session.lifespan: "8h"

# Dashboard and UI settings
#i18n.locale: "en"
#xpack.dashboard_mode.enabled: true
#xpack.dashboard_mode.roles: ["admin", "analyst"]

# Reporting
#xpack.reporting.enabled: true
#xpack.reporting.capture.browser.type: "chromium"

# Fleet and integrations (for Wazuh agents)
#xpack.fleet.enabled: true
#xpack.fleet.agents.enabled: true

# Telemetry
telemetry.enabled: false

# Content Security Policy
#csp.strict: true
#csp.rules:
#  - "script-src 'self' 'unsafe-eval'"
#  - "style-src 'self' 'unsafe-inline'"

# Task Manager
#xpack.task_manager.max_workers: 10

# Alerting
#xpack.alerting.enabled: true

# Spaces
#xpack.spaces.enabled: true

# ======================= End of Configuration =========================